{"paragraphs":[{"text":"%pyspark\nspark","user":"anonymous","dateUpdated":"2018-03-10T11:38:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.session.SparkSession object at 0x7f9a444eb390>\n"}]},"apps":[],"jobName":"paragraph_1520681888114_-329203846","id":"20180310-113808_701075248","dateCreated":"2018-03-10T11:38:08+0000","dateStarted":"2018-03-10T11:38:15+0000","dateFinished":"2018-03-10T11:38:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6528"},{"text":"%pyspark\nfrom pyspark.sql import Row\n\nimport collections","user":"anonymous","dateUpdated":"2018-03-10T11:41:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520682082060_-2126657118","id":"20180310-114122_137130133","dateCreated":"2018-03-10T11:41:22+0000","dateStarted":"2018-03-10T11:41:35+0000","dateFinished":"2018-03-10T11:41:35+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6529"},{"text":"%pyspark\ndef mapper(line):\n    fields = line.split(',')\n    return Row(ID=int(fields[0]), name=str(fields[1].encode(\"utf-8\")), age=int(fields[2]), numFriends=int(fields[3]))\n","user":"anonymous","dateUpdated":"2018-03-10T11:38:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520681895786_-574273572","id":"20180310-113815_1480746694","dateCreated":"2018-03-10T11:38:15+0000","dateStarted":"2018-03-10T11:38:38+0000","dateFinished":"2018-03-10T11:38:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6530"},{"text":"%pyspark\nlines = spark.sparkContext.textFile(\"wasb:///sparkcourse/data/fakefriends.xls\")\npeople = lines.map(mapper)","user":"anonymous","dateUpdated":"2018-03-10T11:40:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520681918530_-932059400","id":"20180310-113838_440767293","dateCreated":"2018-03-10T11:38:38+0000","dateStarted":"2018-03-10T11:40:22+0000","dateFinished":"2018-03-10T11:40:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6531"},{"text":"%pyspark\nschemaPeople = spark.createDataFrame(people).cache()\nschemaPeople.createOrReplaceTempView(\"people\")\n","user":"anonymous","dateUpdated":"2018-03-10T11:41:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520682022834_-1168140339","id":"20180310-114022_1072808028","dateCreated":"2018-03-10T11:40:22+0000","dateStarted":"2018-03-10T11:41:54+0000","dateFinished":"2018-03-10T11:41:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6532"},{"text":"%pyspark\nteenagers = spark.sql(\"SELECT * FROM people WHERE age >= 13 AND age <= 19\")\n# teenagers.show()","user":"anonymous","dateUpdated":"2018-03-10T11:51:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520682037565_1654023492","id":"20180310-114037_365943407","dateCreated":"2018-03-10T11:40:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6533","dateFinished":"2018-03-10T11:51:04+0000","dateStarted":"2018-03-10T11:51:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+-------+----------+\n| ID|age|   name|numFriends|\n+---+---+-------+----------+\n| 21| 19|  Miles|       268|\n| 52| 19|Beverly|       269|\n| 54| 19|  Brunt|         5|\n|106| 18|Beverly|       499|\n|115| 18|  Dukat|       397|\n|133| 19|  Quark|       265|\n|136| 19|   Will|       335|\n|225| 19|   Elim|       106|\n|304| 19|   Will|       404|\n|341| 18|   Data|       326|\n|366| 19|  Keiko|       119|\n|373| 19|  Quark|       272|\n|377| 18|Beverly|       418|\n|404| 18| Kasidy|        24|\n|409| 19|    Nog|       267|\n|439| 18|   Data|       417|\n|444| 18|  Keiko|       472|\n|492| 19|  Dukat|        36|\n|494| 18| Kasidy|       194|\n+---+---+-------+----------+\n\n"}]}},{"text":"%pyspark\nfor teen in teenagers.collect():\n    print(teen)","user":"anonymous","dateUpdated":"2018-03-10T11:50:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520682344848_-476855479","id":"20180310-114544_330178111","dateCreated":"2018-03-10T11:45:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6888","dateFinished":"2018-03-10T11:50:56+0000","dateStarted":"2018-03-10T11:50:56+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(ID=21, age=19, name=u'Miles', numFriends=268)\nRow(ID=52, age=19, name=u'Beverly', numFriends=269)\nRow(ID=54, age=19, name=u'Brunt', numFriends=5)\nRow(ID=106, age=18, name=u'Beverly', numFriends=499)\nRow(ID=115, age=18, name=u'Dukat', numFriends=397)\nRow(ID=133, age=19, name=u'Quark', numFriends=265)\nRow(ID=136, age=19, name=u'Will', numFriends=335)\nRow(ID=225, age=19, name=u'Elim', numFriends=106)\nRow(ID=304, age=19, name=u'Will', numFriends=404)\nRow(ID=341, age=18, name=u'Data', numFriends=326)\nRow(ID=366, age=19, name=u'Keiko', numFriends=119)\nRow(ID=373, age=19, name=u'Quark', numFriends=272)\nRow(ID=377, age=18, name=u'Beverly', numFriends=418)\nRow(ID=404, age=18, name=u'Kasidy', numFriends=24)\nRow(ID=409, age=19, name=u'Nog', numFriends=267)\nRow(ID=439, age=18, name=u'Data', numFriends=417)\nRow(ID=444, age=18, name=u'Keiko', numFriends=472)\nRow(ID=492, age=19, name=u'Dukat', numFriends=36)\nRow(ID=494, age=18, name=u'Kasidy', numFriends=194)\n"}]}},{"text":"%pyspark\nschemaPeople.groupBy(\"age\").count().orderBy(\"age\").show()\n","user":"anonymous","dateUpdated":"2018-03-10T11:47:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520682364785_1919776068","id":"20180310-114604_7526325","dateCreated":"2018-03-10T11:46:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6945","dateFinished":"2018-03-10T11:48:01+0000","dateStarted":"2018-03-10T11:47:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----+\n|age|count|\n+---+-----+\n| 18|    8|\n| 19|   11|\n| 20|    5|\n| 21|    8|\n| 22|    7|\n| 23|   10|\n| 24|    5|\n| 25|   11|\n| 26|   17|\n| 27|    8|\n| 28|   10|\n| 29|   12|\n| 30|   11|\n| 31|    8|\n| 32|   11|\n| 33|   12|\n| 34|    6|\n| 35|    8|\n| 36|   10|\n| 37|    9|\n+---+-----+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-03-10T11:47:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520682478938_-1124621030","id":"20180310-114758_877971415","dateCreated":"2018-03-10T11:47:58+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7133"}],"name":"sundog_udemy","id":"2DB17T5MU","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX6DGQZ:shared_process":[],"2CK8A9MEG:shared_process":[],"2CKX8WPU1:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}
