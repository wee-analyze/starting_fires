{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848529211_1040171185","id":"20180312-095529_236929423","dateCreated":"2018-03-12T09:55:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:233","text":"%pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import Row\nfrom pyspark.sql import functions\n","dateUpdated":"2018-03-12T09:55:47+0000","dateFinished":"2018-03-12T09:56:29+0000","dateStarted":"2018-03-12T09:55:47+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# python function to split the data\n\ndef loadMovieNames():\n    movieNames = {}\n    with open(\"/home/philippe/u.item\") as f:\n        for line in f:\n            fields = line.split('|')\n            movieNames[int(fields[0])] = fields[1]\n    return movieNames\n","user":"anonymous","dateUpdated":"2018-03-12T09:57:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848547434_-1419312350","id":"20180312-095547_1840001089","dateCreated":"2018-03-12T09:55:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:389","dateFinished":"2018-03-12T09:57:53+0000","dateStarted":"2018-03-12T09:57:53+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# Create a SparkSession #(the config bit is only for Windows!)\n\n# when running locally on windows\n# spark = SparkSession.builder.config(\"spark.sql.warehouse.dir\", \"file:///C:/temp\").appName(\"PopularMovies\").getOrCreate()\n\n\nspark = SparkSession.builder.appName(\"PopularMovies\").getOrCreate()\n","user":"anonymous","dateUpdated":"2018-03-12T09:59:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848673716_-1378777442","id":"20180312-095753_1645475433","dateCreated":"2018-03-12T09:57:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:455","dateFinished":"2018-03-12T09:59:15+0000","dateStarted":"2018-03-12T09:59:13+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# Load up our movie ID -> name dictionary\nnameDict = loadMovieNames()\n","user":"anonymous","dateUpdated":"2018-03-12T09:59:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848753379_-562786322","id":"20180312-095913_193869658","dateCreated":"2018-03-12T09:59:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:511","dateFinished":"2018-03-12T09:59:23+0000","dateStarted":"2018-03-12T09:59:23+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# Get the raw data\nlines = spark.sparkContext.textFile(\"wasb:///sparkcourse/data/u.data\")\n","user":"anonymous","dateUpdated":"2018-03-12T09:59:57+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848763257_1616831521","id":"20180312-095923_651457491","dateCreated":"2018-03-12T09:59:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:576","dateFinished":"2018-03-12T09:59:58+0000","dateStarted":"2018-03-12T09:59:57+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# Convert it to a RDD of Row objects\nmovies = lines.map(lambda x: Row(movieID =int(x.split()[1])))\n","user":"anonymous","dateUpdated":"2018-03-12T10:00:21+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848797721_-497871027","id":"20180312-095957_554261351","dateCreated":"2018-03-12T09:59:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:632","dateFinished":"2018-03-12T10:00:21+0000","dateStarted":"2018-03-12T10:00:21+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# Convert that to a DataFrame\nmovieDataset = spark.createDataFrame(movies)\n","user":"anonymous","dateUpdated":"2018-03-12T10:00:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848821889_-687536911","id":"20180312-100021_1752182323","dateCreated":"2018-03-12T10:00:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:697","dateFinished":"2018-03-12T10:00:44+0000","dateStarted":"2018-03-12T10:00:30+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# Some SQL-style magic to sort all movies by popularity in one line!\ntopMovieIDs = movieDataset.groupBy(\"movieID\").count().orderBy(\"count\", ascending=False).cache()\n","user":"anonymous","dateUpdated":"2018-03-12T10:00:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848830682_-194642921","id":"20180312-100030_667482091","dateCreated":"2018-03-12T10:00:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:753","dateFinished":"2018-03-12T10:01:01+0000","dateStarted":"2018-03-12T10:00:48+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ntopMovieIDs.show()\n","user":"anonymous","dateUpdated":"2018-03-12T10:01:03+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848848058_1709894782","id":"20180312-100048_1912583790","dateCreated":"2018-03-12T10:00:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:818","dateFinished":"2018-03-12T10:01:05+0000","dateStarted":"2018-03-12T10:01:03+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+\n|movieID|count|\n+-------+-----+\n|     50|  583|\n|    258|  509|\n|    100|  508|\n|    181|  507|\n|    294|  485|\n|    286|  481|\n|    288|  478|\n|      1|  452|\n|    300|  431|\n|    121|  429|\n|    174|  420|\n|    127|  413|\n|     56|  394|\n|      7|  392|\n|     98|  390|\n|    237|  384|\n|    117|  378|\n|    172|  367|\n|    222|  365|\n|    313|  350|\n+-------+-----+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\n# Grab the top 10\ntop10 = topMovieIDs.take(10)\n","user":"anonymous","dateUpdated":"2018-03-12T10:01:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848863288_-920466526","id":"20180312-100103_2109773740","dateCreated":"2018-03-12T10:01:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:887","dateFinished":"2018-03-12T10:01:14+0000","dateStarted":"2018-03-12T10:01:14+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n# Print the results\nprint(\"\\n\")\nfor result in top10:\n    # Each row has movieID, count as above.\n    print(\"%s: %d\" % (nameDict[result[0]], result[1]))\n","user":"anonymous","dateUpdated":"2018-03-12T10:01:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848874162_866707439","id":"20180312-100114_1026539267","dateCreated":"2018-03-12T10:01:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:972","dateFinished":"2018-03-12T10:01:30+0000","dateStarted":"2018-03-12T10:01:30+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\nStar Wars (1977): 583\nContact (1997): 509\nFargo (1996): 508\nReturn of the Jedi (1983): 507\nLiar Liar (1997): 485\nEnglish Patient, The (1996): 481\nScream (1996): 478\nToy Story (1995): 452\nAir Force One (1997): 431\nIndependence Day (ID4) (1996): 429\n"}]}},{"text":"%pyspark\n# Stop the session\nspark.stop()\n","user":"anonymous","dateUpdated":"2018-03-12T10:01:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848890481_-1217077280","id":"20180312-100130_417358615","dateCreated":"2018-03-12T10:01:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1037","dateFinished":"2018-03-12T10:01:39+0000","dateStarted":"2018-03-12T10:01:39+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2018-03-12T10:01:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520848898993_98394534","id":"20180312-100138_1290904314","dateCreated":"2018-03-12T10:01:38+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1109"}],"name":"popular_movies_dataframe","id":"2D97XZY87","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX6DGQZ:shared_process":[],"2CK8A9MEG:shared_process":[],"2CKX8WPU1:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}