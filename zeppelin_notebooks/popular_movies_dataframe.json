{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import Row\nfrom pyspark.sql import functions\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716686_1321405295","id":"20180312-095529_236929423","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1060"},{"text":"%pyspark\n# python function to split the data\n\ndef loadMovieNames():\n    movieNames = {}\n    with open(\"/home/usr/u.item\") as f:\n        for line in f:\n            fields = line.split('|')\n            movieNames[int(fields[0])] = fields[1]\n    return movieNames\n","dateUpdated":"2018-03-12T12:12:35+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716690_1332178264","id":"20180312-095547_1840001089","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1061"},{"text":"%pyspark\n# Create a SparkSession #(the config bit is only for Windows!)\n\n# when running locally on windows\n# spark = SparkSession.builder.config(\"spark.sql.warehouse.dir\", \"file:///C:/temp\").appName(\"PopularMovies\").getOrCreate()\n\n\nspark = SparkSession.builder.appName(\"PopularMovies\").getOrCreate()\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716690_1332178264","id":"20180312-095753_1645475433","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1062"},{"text":"%pyspark\n# Load up our movie ID -> name dictionary\nnameDict = loadMovieNames()\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716691_1331793515","id":"20180312-095913_193869658","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1063"},{"text":"%pyspark\n# Get the raw data\nlines = spark.sparkContext.textFile(\"hdfs:/.../u.data\")\n","dateUpdated":"2018-03-12T12:12:54+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716692_1329869770","id":"20180312-095923_651457491","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1064"},{"text":"%pyspark\n# Convert it to a RDD of Row objects\nmovies = lines.map(lambda x: Row(movieID =int(x.split()[1])))\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716692_1329869770","id":"20180312-095957_554261351","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1065"},{"text":"%pyspark\n# Convert that to a DataFrame\nmovieDataset = spark.createDataFrame(movies)\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716693_1329485021","id":"20180312-100021_1752182323","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1066"},{"text":"%pyspark\n# Some SQL-style magic to sort all movies by popularity in one line!\ntopMovieIDs = movieDataset.groupBy(\"movieID\").count().orderBy(\"count\", ascending=False).cache()\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716694_1330639268","id":"20180312-100030_667482091","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1067"},{"text":"%pyspark\ntopMovieIDs.show()\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+\n|movieID|count|\n+-------+-----+\n|     50|  583|\n|    258|  509|\n|    100|  508|\n|    181|  507|\n|    294|  485|\n|    286|  481|\n|    288|  478|\n|      1|  452|\n|    300|  431|\n|    121|  429|\n|    174|  420|\n|    127|  413|\n|     56|  394|\n|      7|  392|\n|     98|  390|\n|    237|  384|\n|    117|  378|\n|    172|  367|\n|    222|  365|\n|    313|  350|\n+-------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1520856716694_1330639268","id":"20180312-100048_1912583790","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1068"},{"text":"%pyspark\n# Grab the top 10\ntop10 = topMovieIDs.take(10)\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716695_1330254519","id":"20180312-100103_2109773740","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1069"},{"text":"%pyspark\n# Print the results\nprint(\"\\n\")\nfor result in top10:\n    # Each row has movieID, count as above.\n    print(\"%s: %d\" % (nameDict[result[0]], result[1]))\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n\nStar Wars (1977): 583\nContact (1997): 509\nFargo (1996): 508\nReturn of the Jedi (1983): 507\nLiar Liar (1997): 485\nEnglish Patient, The (1996): 481\nScream (1996): 478\nToy Story (1995): 452\nAir Force One (1997): 431\nIndependence Day (ID4) (1996): 429\n"}]},"apps":[],"jobName":"paragraph_1520856716696_1328330775","id":"20180312-100114_1026539267","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1070"},{"text":"%pyspark\n# Stop the session\nspark.stop()\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520856716696_1328330775","id":"20180312-100130_417358615","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1071"},{"text":"%pyspark\n","dateUpdated":"2018-03-12T12:11:56+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520856716697_1327946026","id":"20180312-100138_1290904314","dateCreated":"2018-03-12T12:11:56+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1072"}],"name":"popular_movies_dataframe","id":"2DBCWR2MR","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX6DGQZ:shared_process":[],"2CK8A9MEG:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKX8WPU1:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}