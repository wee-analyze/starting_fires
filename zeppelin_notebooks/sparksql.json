{"paragraphs":[{"text":"%pyspark\nspark","dateUpdated":"2018-03-12T09:52:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<pyspark.sql.session.SparkSession object at 0x7f9a444eb390>\n"}]},"apps":[],"jobName":"paragraph_1520847898713_720721805","id":"20180310-113808_701075248","dateCreated":"2018-03-12T09:44:58+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:181"},{"text":"%pyspark\nfrom pyspark.sql import Row\nimport collections","dateUpdated":"2018-03-12T09:52:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520847898717_719182810","id":"20180310-114122_137130133","dateCreated":"2018-03-12T09:44:58+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:182"},{"text":"%pyspark\ndef mapper(line):\n    fields = line.split(',')\n    return Row(ID=int(fields[0]), name=str(fields[1].encode(\"utf-8\")), age=int(fields[2]), numFriends=int(fields[3]))\n","dateUpdated":"2018-03-12T09:52:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520847898718_720337056","id":"20180310-113815_1480746694","dateCreated":"2018-03-12T09:44:58+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:183"},{"text":"%pyspark\nlines = spark.sparkContext.textFile(\"hdfs://.../fakefriends.xls\")\npeople = lines.map(mapper)","dateUpdated":"2018-03-12T09:52:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520847898720_705716598","id":"20180310-113838_440767293","dateCreated":"2018-03-12T09:44:58+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:184"},{"text":"%pyspark\n# Infer the schema, and register the DataFrame as a table.\n\nschemaPeople = spark.createDataFrame(people).cache()\nschemaPeople.createOrReplaceTempView(\"people\")\n","dateUpdated":"2018-03-12T09:52:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1520847898721_705331849","id":"20180310-114022_1072808028","dateCreated":"2018-03-12T09:44:58+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:185"},{"text":"%pyspark\n# SQL can be run over DataFrames that have been registered as a table.\n\nteenagers = spark.sql(\"SELECT * FROM people WHERE age >= 13 AND age <= 19\")\n# teenagers.show()","dateUpdated":"2018-03-12T09:52:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+-------+----------+\n| ID|age|   name|numFriends|\n+---+---+-------+----------+\n| 21| 19|  Miles|       268|\n| 52| 19|Beverly|       269|\n| 54| 19|  Brunt|         5|\n|106| 18|Beverly|       499|\n|115| 18|  Dukat|       397|\n|133| 19|  Quark|       265|\n|136| 19|   Will|       335|\n|225| 19|   Elim|       106|\n|304| 19|   Will|       404|\n|341| 18|   Data|       326|\n|366| 19|  Keiko|       119|\n|373| 19|  Quark|       272|\n|377| 18|Beverly|       418|\n|404| 18| Kasidy|        24|\n|409| 19|    Nog|       267|\n|439| 18|   Data|       417|\n|444| 18|  Keiko|       472|\n|492| 19|  Dukat|        36|\n|494| 18| Kasidy|       194|\n+---+---+-------+----------+\n\n"}]},"apps":[],"jobName":"paragraph_1520847898722_706486096","id":"20180310-114037_365943407","dateCreated":"2018-03-12T09:44:58+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:186"},{"text":"%pyspark\n# The results of SQL queries are RDDs and support all the normal RDD operations.\n\nfor teen in teenagers.collect():\n    print(teen)","dateUpdated":"2018-03-12T09:52:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(ID=21, age=19, name=u'Miles', numFriends=268)\nRow(ID=52, age=19, name=u'Beverly', numFriends=269)\nRow(ID=54, age=19, name=u'Brunt', numFriends=5)\nRow(ID=106, age=18, name=u'Beverly', numFriends=499)\nRow(ID=115, age=18, name=u'Dukat', numFriends=397)\nRow(ID=133, age=19, name=u'Quark', numFriends=265)\nRow(ID=136, age=19, name=u'Will', numFriends=335)\nRow(ID=225, age=19, name=u'Elim', numFriends=106)\nRow(ID=304, age=19, name=u'Will', numFriends=404)\nRow(ID=341, age=18, name=u'Data', numFriends=326)\nRow(ID=366, age=19, name=u'Keiko', numFriends=119)\nRow(ID=373, age=19, name=u'Quark', numFriends=272)\nRow(ID=377, age=18, name=u'Beverly', numFriends=418)\nRow(ID=404, age=18, name=u'Kasidy', numFriends=24)\nRow(ID=409, age=19, name=u'Nog', numFriends=267)\nRow(ID=439, age=18, name=u'Data', numFriends=417)\nRow(ID=444, age=18, name=u'Keiko', numFriends=472)\nRow(ID=492, age=19, name=u'Dukat', numFriends=36)\nRow(ID=494, age=18, name=u'Kasidy', numFriends=194)\n"}]},"apps":[],"jobName":"paragraph_1520847898723_706101347","id":"20180310-114544_330178111","dateCreated":"2018-03-12T09:44:58+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:187"},{"text":"%pyspark\n# We can also use functions instead of SQL queries:\n\nschemaPeople.groupBy(\"age\").count().orderBy(\"age\").show()\n","dateUpdated":"2018-03-12T09:52:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----+\n|age|count|\n+---+-----+\n| 18|    8|\n| 19|   11|\n| 20|    5|\n| 21|    8|\n| 22|    7|\n| 23|   10|\n| 24|    5|\n| 25|   11|\n| 26|   17|\n| 27|    8|\n| 28|   10|\n| 29|   12|\n| 30|   11|\n| 31|    8|\n| 32|   11|\n| 33|   12|\n| 34|    6|\n| 35|    8|\n| 36|   10|\n| 37|    9|\n+---+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1520847898724_704177603","id":"20180310-114604_7526325","dateCreated":"2018-03-12T09:44:58+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:188"},{"text":"%pyspark\n# stop the connection\n\nspark.stop()\n","dateUpdated":"2018-03-12T09:52:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"editorHide":false,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1520847898724_704177603","id":"20180310-114758_877971415","dateCreated":"2018-03-12T09:44:58+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:189"}],"name":"sparksql","id":"2DA4H5ZQ5","angularObjects":{"2CHS8UYQQ:shared_process":[],"2CKX6DGQZ:shared_process":[],"2CK8A9MEG:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKX8WPU1:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}